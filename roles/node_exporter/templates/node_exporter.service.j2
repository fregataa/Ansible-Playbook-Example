[Unit]
Description=Prometheus Node Exporter
Documentation=https://github.com/prometheus/node_exporter
After=network-online.target
Wants=network-online.target

[Service]
Type=simple
User=monitoring
Group=monitoring
ExecStart={{ install_dir }}/node_exporter/node_exporter \
    --web.listen-address=:{{ node_exporter_port }} \
    --collector.textfile.directory={{ node_exporter_textfile_dir }} \
{% for collector in node_exporter_collectors %}
    --collector.{{ collector }} \
{% endfor %}
    --log.level={{ log_level }}

Restart={{ systemd_restart_policy }}
RestartSec={{ systemd_restart_sec }}

# 보안 설정
NoNewPrivileges=yes
ProtectSystem=strict
ProtectHome=yes
ReadWritePaths={{ node_exporter_textfile_dir }}

[Install]
WantedBy=multi-user.target
